# 一种新的各向异性模型的法线计算及理论推导
* 在现在的图形学渲染过程中，各向异性材质是一种常见的材质，其在拉丝金属，发丝等模型上有着相当广泛的用途。在现在的各向异性材质渲染过程中，通常依赖于sin(T, H)这个经验公式来对光照进行计算，并给出最终颜色。在这里，我们提出一种新的基于物理的各向异性材质计算，并给出数学推导
* 首先，对各向异性材质进行简要分析，各向异性材质往往表现为若干个紧密排列的圆柱，并且这些圆柱的宽度通常是小于一个像素的，那么当我们在渲染这个各向异性材质时，实际上就应该去求得这个亚像素级别的圆柱的表面法线的均值，如果从更严谨的角度来考虑的话，其实还应该求得法线分布函数，并将法线分布函数作为函数g(x)，与其他的法线分布函数合为一个复合函数f(g(x))，作为最终的法线分布函数，并参与到最终的光照计算中
* 每一个微小的圆柱的形状，以及法线分布的形状已经被传烂了，但还是在这里发一下
![圆柱法线](Asset/一种新的各向异性模型的法线计算及理论推导/圆柱表面法线.jpg)
* 当我们从一个方向看向这个物体时，实际上看到的是这个圆柱的一小部分，类似于下图
![摄像机看到的柱面](Asset/一种新的各向异性模型的法线计算及理论推导/摄像机看到的柱面.png)
* 然后其实我们可以简单地积分得到，摄像机视角下，当看到一个完整的柱面时，所得到的一个平均法线"看起来"就是我们的ToEye的方向，也就是向量CE的方向，但显然，视角的方向很少会刚好处在圆柱的法平面上，所以这里的公式还需要进一步的处理，不过其实空间立体想象力好一些的同志已经想到了，我们积分得到的平均应该就是ToEye在圆柱的法平面上的投影，公式是normalize(ToEye - dot(ToEye, Tangent) * Tangent)
* 另外一个扩展是这样，我们或许可以为每个点再额外指定一个法线，以及一个展露角，这样的话积分时在角度上就需要考虑展露角对积分范围的影响，或许效果上会更真实一些，但是可能也说不准